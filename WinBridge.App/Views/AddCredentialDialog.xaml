<ContentDialog
    x:Class="WinBridge.App.Views.AddCredentialDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:WinBridge.Core.Models"
    mc:Ignorable="d"
    Title="Ajouter un identifiant"
    PrimaryButtonText="Ajouter"
    CloseButtonText="Annuler"
    DefaultButton="Primary"
    PrimaryButtonClick="ContentDialog_PrimaryButtonClick">

    <ContentDialog.Resources>
        <Style TargetType="TextBlock" x:Key="LabelStyle">
            <Setter Property="Margin" Value="0,0,0,8"/>
            <Setter Property="Foreground" Value="{ThemeResource TextFillColorSecondaryBrush}"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
    </ContentDialog.Resources>

    <StackPanel Spacing="16" Width="400">
        <!-- Display Name -->
        <StackPanel>
            <TextBlock Text="Nom de l'identifiant" Style="{StaticResource LabelStyle}"/>
            <TextBox x:Name="NameBox" PlaceholderText="Ex: Serveur Prod" />
        </StackPanel>

        <!-- User Name -->
        <StackPanel>
            <TextBlock Text="Nom d'utilisateur" Style="{StaticResource LabelStyle}"/>
            <TextBox x:Name="UserBox" PlaceholderText="Ex: root, admin" />
        </StackPanel>

        <!-- Type -->
        <StackPanel>
            <TextBlock Text="Type d'authentification" Style="{StaticResource LabelStyle}"/>
            <ComboBox x:Name="TypeComboBox" HorizontalAlignment="Stretch" SelectedIndex="0" SelectionChanged="TypeComboBox_SelectionChanged">
                <ComboBoxItem Content="Mot de passe" Tag="Password" />
                <ComboBoxItem Content="ClÃ© SSH" Tag="SshKey" />
            </ComboBox>
        </StackPanel>

        <!-- Password Input -->
        <StackPanel x:Name="PasswordPanel">
            <TextBlock Text="Mot de passe" Style="{StaticResource LabelStyle}"/>
            <PasswordBox x:Name="PasswordBox" />
        </StackPanel>

        <!-- SSH Key Input -->
        <StackPanel x:Name="SshKeyPanel" Visibility="Collapsed" Spacing="8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="ClÃ© privÃ©e" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                <Button Grid.Column="1" Click="ImportFile_Click" Style="{StaticResource DateTimePickerFlyoutButtonStyle}" Padding="4,2" ToolTipService.ToolTip="Importer depuis un fichier">
                    <StackPanel Orientation="Horizontal" Spacing="4">
                        <FontIcon Glyph="&#xE896;" FontSize="14"/>
                        <TextBlock Text="Importer" FontSize="12"/>
                    </StackPanel>
                </Button>
            </Grid>
            
            <TextBox x:Name="SshKeyBox" 
                     AcceptsReturn="True" 
                     TextWrapping="Wrap" 
                     Height="120" 
                     FontFamily="Consolas" 
                     PlaceholderText="-----BEGIN OPENSSH PRIVATE KEY-----..." 
                     TextChanged="SshKeyBox_TextChanged"/>
            
            <TextBlock x:Name="SshValidationMessage" 
                       Text="La clÃ© doit commencer par -----BEGIN" 
                       Foreground="{ThemeResource SystemFillColorCriticalBrush}" 
                       FontSize="12" 
                       Visibility="Collapsed"/>

            <!-- Sudo Password (Optional) -->
            <StackPanel x:Name="SudoPasswordPanel">
                <TextBlock Text="Mot de passe Sudo (Optionnel)" Style="{StaticResource LabelStyle}"/>
                <PasswordBox x:Name="SudoPasswordBox" PlaceholderText="UtilisÃ© si la session requiert une Ã©lÃ©vation" />
            </StackPanel>
        </StackPanel>
        
        <!-- Error Message General -->
        <TextBlock x:Name="ErrorMessage" Foreground="{ThemeResource SystemFillColorCriticalBrush}" TextWrapping="Wrap" Visibility="Collapsed" />
    </StackPanel>
</ContentDialog>

